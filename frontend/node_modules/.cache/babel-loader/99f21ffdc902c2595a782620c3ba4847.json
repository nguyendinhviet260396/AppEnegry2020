{"ast":null,"code":"import { cloneEvent, isNaN } from '../util/base';\nvar abs = Math.abs;\nvar DRAG_OFFSET = 10;\nvar ALLOW_EVENTS = ['shift', 'ctrl', 'alt', 'control'];\nexport default {\n  getDefaultCfg: function getDefaultCfg() {\n    return {\n      direction: 'both',\n      enableOptimize: false\n    };\n  },\n  getEvents: function getEvents() {\n    return {\n      dragstart: 'onMouseDown',\n      mousedown: 'onMouseDown',\n      drag: 'onMouseMove',\n      dragend: 'onMouseUp',\n      mouseup: 'onMouseUp',\n      'canvas:click': 'onMouseUp',\n      keyup: 'onKeyUp',\n      focus: 'onKeyUp',\n      keydown: 'onKeyDown'\n    };\n  },\n  updateViewport: function updateViewport(e) {\n    var origin = this.origin;\n    var clientX = +e.clientX;\n    var clientY = +e.clientY;\n\n    if (isNaN(clientX) || isNaN(clientY)) {\n      return;\n    }\n\n    var dx = clientX - origin.x;\n    var dy = clientY - origin.y;\n\n    if (this.get('direction') === 'x') {\n      dy = 0;\n    } else if (this.get('direction') === 'y') {\n      dx = 0;\n    }\n\n    this.origin = {\n      x: clientX,\n      y: clientY\n    };\n    var width = this.graph.get('width');\n    var height = this.graph.get('height');\n    var graphCanvasBBox = this.graph.get('canvas').getCanvasBBox();\n\n    if (graphCanvasBBox.minX <= width && graphCanvasBBox.minX + dx > width || graphCanvasBBox.maxX >= 0 && graphCanvasBBox.maxX + dx < 0) {\n      dx = 0;\n    }\n\n    if (graphCanvasBBox.minY <= height && graphCanvasBBox.minY + dy > height || graphCanvasBBox.maxY >= 0 && graphCanvasBBox.maxY + dy < 0) {\n      dy = 0;\n    }\n\n    this.graph.translate(dx, dy);\n  },\n  onMouseDown: function onMouseDown(e) {\n    var self = this;\n\n    if (window && window.event && typeof window !== 'undefined' && !window.event.buttons && !window.event.button) {\n      return;\n    }\n\n    if (self.keydown || e.shape) {\n      return;\n    }\n\n    self.origin = {\n      x: e.clientX,\n      y: e.clientY\n    };\n    self.dragging = false;\n\n    if (this.enableOptimize) {\n      // 拖动 canvas 过程中隐藏所有的边及label\n      var graph = this.graph;\n      var edges = graph.getEdges();\n\n      for (var i = 0, len = edges.length; i < len; i++) {\n        graph.hideItem(edges[i]);\n      }\n\n      var nodes = graph.getNodes();\n\n      for (var j = 0, nodeLen = nodes.length; j < nodeLen; j++) {\n        var container = nodes[j].getContainer();\n        var children = container.get('children');\n\n        for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n          var child = children_1[_i];\n          var isKeyShape = child.get('isKeyShape');\n\n          if (!isKeyShape) {\n            child.hide();\n          }\n        }\n      }\n    }\n  },\n  onMouseMove: function onMouseMove(e) {\n    var graph = this.graph;\n\n    if (this.keydown || e.shape) {\n      return;\n    }\n\n    e = cloneEvent(e);\n\n    if (!this.origin) {\n      return;\n    }\n\n    if (!this.dragging) {\n      if (abs(this.origin.x - e.clientX) + abs(this.origin.y - e.clientY) < DRAG_OFFSET) {\n        return;\n      }\n\n      if (this.shouldBegin.call(this, e)) {\n        e.type = 'dragstart';\n        graph.emit('canvas:dragstart', e);\n        this.dragging = true;\n      }\n    } else {\n      e.type = 'drag';\n      graph.emit('canvas:drag', e);\n    }\n\n    if (this.shouldUpdate.call(this, e)) {\n      this.updateViewport(e);\n    }\n  },\n  onMouseUp: function onMouseUp(e) {\n    var graph = this.graph;\n\n    if (this.keydown || e.shape) {\n      return;\n    }\n\n    if (this.enableOptimize) {\n      // 拖动结束后显示所有的边\n      var edges = graph.getEdges();\n\n      for (var i = 0, len = edges.length; i < len; i++) {\n        graph.showItem(edges[i]);\n      }\n\n      var nodes = graph.getNodes();\n\n      for (var j = 0, nodeLen = nodes.length; j < nodeLen; j++) {\n        var container = nodes[j].getContainer();\n        var children = container.get('children');\n\n        for (var _i = 0, children_2 = children; _i < children_2.length; _i++) {\n          var child = children_2[_i];\n          var isKeyShape = child.get('isKeyShape');\n\n          if (!isKeyShape) {\n            child.show();\n          }\n        }\n      }\n    }\n\n    if (!this.dragging) {\n      this.origin = null;\n      return;\n    }\n\n    e = cloneEvent(e);\n\n    if (this.shouldEnd.call(this, e)) {\n      this.updateViewport(e);\n    }\n\n    e.type = 'dragend';\n    graph.emit('canvas:dragend', e);\n    this.endDrag();\n  },\n  endDrag: function endDrag() {\n    this.origin = null;\n    this.dragging = false;\n    this.dragbegin = false;\n  },\n  onKeyDown: function onKeyDown(e) {\n    var self = this;\n    var code = e.key;\n\n    if (!code) {\n      return;\n    }\n\n    if (ALLOW_EVENTS.indexOf(code.toLowerCase()) > -1) {\n      self.keydown = true;\n    } else {\n      self.keydown = false;\n    }\n  },\n  onKeyUp: function onKeyUp() {\n    this.keydown = false;\n    this.origin = null;\n    this.dragging = false;\n    this.dragbegin = false;\n  }\n};","map":{"version":3,"sources":["C:/Users/vietn/Desktop/AppEnegry2020/frontend/node_modules/@antv/g6/es/behavior/drag-canvas.js"],"names":["cloneEvent","isNaN","abs","Math","DRAG_OFFSET","ALLOW_EVENTS","getDefaultCfg","direction","enableOptimize","getEvents","dragstart","mousedown","drag","dragend","mouseup","keyup","focus","keydown","updateViewport","e","origin","clientX","clientY","dx","x","dy","y","get","width","graph","height","graphCanvasBBox","getCanvasBBox","minX","maxX","minY","maxY","translate","onMouseDown","self","window","event","buttons","button","shape","dragging","edges","getEdges","i","len","length","hideItem","nodes","getNodes","j","nodeLen","container","getContainer","children","_i","children_1","child","isKeyShape","hide","onMouseMove","shouldBegin","call","type","emit","shouldUpdate","onMouseUp","showItem","children_2","show","shouldEnd","endDrag","dragbegin","onKeyDown","code","key","indexOf","toLowerCase","onKeyUp"],"mappings":"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","sourcesContent":["import { cloneEvent, isNaN } from '../util/base';\nvar abs = Math.abs;\nvar DRAG_OFFSET = 10;\nvar ALLOW_EVENTS = ['shift', 'ctrl', 'alt', 'control'];\nexport default {\n  getDefaultCfg: function getDefaultCfg() {\n    return {\n      direction: 'both',\n      enableOptimize: false\n    };\n  },\n  getEvents: function getEvents() {\n    return {\n      dragstart: 'onMouseDown',\n      mousedown: 'onMouseDown',\n      drag: 'onMouseMove',\n      dragend: 'onMouseUp',\n      mouseup: 'onMouseUp',\n      'canvas:click': 'onMouseUp',\n      keyup: 'onKeyUp',\n      focus: 'onKeyUp',\n      keydown: 'onKeyDown'\n    };\n  },\n  updateViewport: function updateViewport(e) {\n    var origin = this.origin;\n    var clientX = +e.clientX;\n    var clientY = +e.clientY;\n\n    if (isNaN(clientX) || isNaN(clientY)) {\n      return;\n    }\n\n    var dx = clientX - origin.x;\n    var dy = clientY - origin.y;\n\n    if (this.get('direction') === 'x') {\n      dy = 0;\n    } else if (this.get('direction') === 'y') {\n      dx = 0;\n    }\n\n    this.origin = {\n      x: clientX,\n      y: clientY\n    };\n    var width = this.graph.get('width');\n    var height = this.graph.get('height');\n    var graphCanvasBBox = this.graph.get('canvas').getCanvasBBox();\n\n    if (graphCanvasBBox.minX <= width && graphCanvasBBox.minX + dx > width || graphCanvasBBox.maxX >= 0 && graphCanvasBBox.maxX + dx < 0) {\n      dx = 0;\n    }\n\n    if (graphCanvasBBox.minY <= height && graphCanvasBBox.minY + dy > height || graphCanvasBBox.maxY >= 0 && graphCanvasBBox.maxY + dy < 0) {\n      dy = 0;\n    }\n\n    this.graph.translate(dx, dy);\n  },\n  onMouseDown: function onMouseDown(e) {\n    var self = this;\n\n    if (window && window.event && typeof window !== 'undefined' && !window.event.buttons && !window.event.button) {\n      return;\n    }\n\n    if (self.keydown || e.shape) {\n      return;\n    }\n\n    self.origin = {\n      x: e.clientX,\n      y: e.clientY\n    };\n    self.dragging = false;\n\n    if (this.enableOptimize) {\n      // 拖动 canvas 过程中隐藏所有的边及label\n      var graph = this.graph;\n      var edges = graph.getEdges();\n\n      for (var i = 0, len = edges.length; i < len; i++) {\n        graph.hideItem(edges[i]);\n      }\n\n      var nodes = graph.getNodes();\n\n      for (var j = 0, nodeLen = nodes.length; j < nodeLen; j++) {\n        var container = nodes[j].getContainer();\n        var children = container.get('children');\n\n        for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n          var child = children_1[_i];\n          var isKeyShape = child.get('isKeyShape');\n\n          if (!isKeyShape) {\n            child.hide();\n          }\n        }\n      }\n    }\n  },\n  onMouseMove: function onMouseMove(e) {\n    var graph = this.graph;\n\n    if (this.keydown || e.shape) {\n      return;\n    }\n\n    e = cloneEvent(e);\n\n    if (!this.origin) {\n      return;\n    }\n\n    if (!this.dragging) {\n      if (abs(this.origin.x - e.clientX) + abs(this.origin.y - e.clientY) < DRAG_OFFSET) {\n        return;\n      }\n\n      if (this.shouldBegin.call(this, e)) {\n        e.type = 'dragstart';\n        graph.emit('canvas:dragstart', e);\n        this.dragging = true;\n      }\n    } else {\n      e.type = 'drag';\n      graph.emit('canvas:drag', e);\n    }\n\n    if (this.shouldUpdate.call(this, e)) {\n      this.updateViewport(e);\n    }\n  },\n  onMouseUp: function onMouseUp(e) {\n    var graph = this.graph;\n\n    if (this.keydown || e.shape) {\n      return;\n    }\n\n    if (this.enableOptimize) {\n      // 拖动结束后显示所有的边\n      var edges = graph.getEdges();\n\n      for (var i = 0, len = edges.length; i < len; i++) {\n        graph.showItem(edges[i]);\n      }\n\n      var nodes = graph.getNodes();\n\n      for (var j = 0, nodeLen = nodes.length; j < nodeLen; j++) {\n        var container = nodes[j].getContainer();\n        var children = container.get('children');\n\n        for (var _i = 0, children_2 = children; _i < children_2.length; _i++) {\n          var child = children_2[_i];\n          var isKeyShape = child.get('isKeyShape');\n\n          if (!isKeyShape) {\n            child.show();\n          }\n        }\n      }\n    }\n\n    if (!this.dragging) {\n      this.origin = null;\n      return;\n    }\n\n    e = cloneEvent(e);\n\n    if (this.shouldEnd.call(this, e)) {\n      this.updateViewport(e);\n    }\n\n    e.type = 'dragend';\n    graph.emit('canvas:dragend', e);\n    this.endDrag();\n  },\n  endDrag: function endDrag() {\n    this.origin = null;\n    this.dragging = false;\n    this.dragbegin = false;\n  },\n  onKeyDown: function onKeyDown(e) {\n    var self = this;\n    var code = e.key;\n\n    if (!code) {\n      return;\n    }\n\n    if (ALLOW_EVENTS.indexOf(code.toLowerCase()) > -1) {\n      self.keydown = true;\n    } else {\n      self.keydown = false;\n    }\n  },\n  onKeyUp: function onKeyUp() {\n    this.keydown = false;\n    this.origin = null;\n    this.dragging = false;\n    this.dragbegin = false;\n  }\n};"]},"metadata":{},"sourceType":"module"}