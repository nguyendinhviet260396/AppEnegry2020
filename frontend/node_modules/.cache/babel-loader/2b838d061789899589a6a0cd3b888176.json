{"ast":null,"code":"import React, { useEffect } from 'react';\nimport G6 from '@antv/g6/es';\nimport { ErrorBoundary } from '../base';\nimport { customIconNode } from './customItems';\nimport { getGraphSize, processMinimap } from './util';\nimport useGraph from '../hooks/useGraph';\nvar defaultStateStyles = {\n  hover: {\n    stroke: '#1890ff',\n    lineWidth: 2\n  }\n};\nvar defaultNodeStyle = {\n  fill: '#91d5ff',\n  stroke: '#40a9ff',\n  radius: 5\n};\nvar defaultEdgeStyle = {\n  stroke: '#91d5ff',\n  endArrow: {\n    path: 'M 0,0 L 12, 6 L 9,0 L 12, -6 Z',\n    fill: '#91d5ff',\n    d: -20\n  }\n};\nvar defaultLayout = {\n  type: 'compactBox',\n  direction: 'TB',\n  getId: function getId(d) {\n    return d.id;\n  },\n  getHeight: function getHeight() {\n    return 16;\n  },\n  getWidth: function getWidth() {\n    return 16;\n  },\n  getVGap: function getVGap() {\n    return 40;\n  },\n  getHGap: function getHGap() {\n    return 70;\n  }\n};\nvar defaultLabelCfg = {\n  style: {\n    fill: '#000',\n    fontSize: 12\n  }\n};\nvar graph;\n\nvar OrganizationTreeGraphComponent = function OrganizationTreeGraphComponent(_ref) {\n  var data = _ref.data,\n      className = _ref.className,\n      style = _ref.style,\n      width = _ref.width,\n      height = _ref.height,\n      _ref$nodeType = _ref.nodeType,\n      nodeType = _ref$nodeType === void 0 ? 'rect' : _ref$nodeType,\n      _ref$edgeType = _ref.edgeType,\n      edgeType = _ref$edgeType === void 0 ? 'flow-line' : _ref$edgeType,\n      _ref$collapseExpand = _ref.collapseExpand,\n      collapseExpand = _ref$collapseExpand === void 0 ? false : _ref$collapseExpand,\n      _ref$nodeSize = _ref.nodeSize,\n      nodeSize = _ref$nodeSize === void 0 ? [120, 40] : _ref$nodeSize,\n      _ref$nodeLabelCfg = _ref.nodeLabelCfg,\n      nodeLabelCfg = _ref$nodeLabelCfg === void 0 ? defaultLabelCfg : _ref$nodeLabelCfg,\n      _ref$edgeLabelCfg = _ref.edgeLabelCfg,\n      edgeLabelCfg = _ref$edgeLabelCfg === void 0 ? defaultLabelCfg : _ref$edgeLabelCfg,\n      _ref$layout = _ref.layout,\n      layout = _ref$layout === void 0 ? defaultLayout : _ref$layout,\n      _ref$enableEdit = _ref.enableEdit,\n      enableEdit = _ref$enableEdit === void 0 ? false : _ref$enableEdit,\n      minimapCfg = _ref.minimapCfg,\n      _ref$nodeStyle = _ref.nodeStyle,\n      nodeStyle = _ref$nodeStyle === void 0 ? defaultNodeStyle : _ref$nodeStyle,\n      _ref$edgeStyle = _ref.edgeStyle,\n      edgeStyle = _ref$edgeStyle === void 0 ? defaultEdgeStyle : _ref$edgeStyle,\n      _ref$nodeStateStyles = _ref.nodeStateStyles,\n      nodeStateStyles = _ref$nodeStateStyles === void 0 ? defaultStateStyles : _ref$nodeStateStyles,\n      _ref$edgeStateStyles = _ref.edgeStateStyles,\n      edgeStateStyles = _ref$edgeStateStyles === void 0 ? defaultStateStyles : _ref$edgeStateStyles,\n      handleNodeClick = _ref.handleNodeClick,\n      handleEdgeClick = _ref.handleEdgeClick,\n      handleNodeHover = _ref.handleNodeHover,\n      handleNodeUnHover = _ref.handleNodeUnHover,\n      handleEdgeHover = _ref.handleEdgeHover,\n      handleEdgeUnHover = _ref.handleEdgeUnHover,\n      handleCanvasClick = _ref.handleCanvasClick,\n      graphRef = _ref.graphRef;\n  var props = {\n    data: data,\n    className: className,\n    style: style,\n    width: width,\n    height: height,\n    nodeType: nodeType,\n    edgeType: edgeType,\n    collapseExpand: collapseExpand,\n    nodeSize: nodeSize,\n    nodeLabelCfg: nodeLabelCfg,\n    edgeLabelCfg: edgeLabelCfg,\n    layout: layout,\n    enableEdit: enableEdit,\n    minimapCfg: minimapCfg,\n    nodeStyle: nodeStyle,\n    edgeStyle: edgeStyle,\n    nodeStateStyles: nodeStateStyles,\n    edgeStateStyles: edgeStateStyles,\n    handleNodeClick: handleNodeClick,\n    handleEdgeClick: handleEdgeClick,\n    handleNodeHover: handleNodeHover,\n    handleNodeUnHover: handleNodeUnHover,\n    handleEdgeHover: handleEdgeHover,\n    handleEdgeUnHover: handleEdgeUnHover,\n    handleCanvasClick: handleCanvasClick,\n    graphRef: graphRef\n  };\n  var container = React.useRef(null);\n  useGraph(graph, props, container);\n  useEffect(function () {\n    var graphSize = getGraphSize(width, height, container);\n\n    if (!graph || graph.destroyed) {\n      if (nodeType === 'icon-node') {\n        customIconNode({\n          enableEdit: enableEdit\n        });\n      }\n\n      graph = new G6.TreeGraph({\n        container: container.current,\n        width: graphSize[0],\n        height: graphSize[1],\n        linkCenter: true,\n        modes: {\n          default: ['drag-canvas', 'zoom-canvas']\n        },\n        defaultNode: {\n          type: nodeType,\n          size: nodeSize,\n          style: nodeStyle,\n          labelCfg: nodeLabelCfg\n        },\n        defaultEdge: {\n          type: edgeType,\n          style: edgeStyle,\n          labelCfg: edgeLabelCfg\n        },\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        layout: layout\n      });\n\n      if (graphRef) {\n        graphRef.current = graph;\n      }\n    }\n\n    processMinimap(minimapCfg, graph);\n    graph.data(data);\n    graph.render();\n    graph.fitView();\n\n    if (collapseExpand) {\n      graph.addBehaviors({\n        type: 'collapse-expand',\n        onChange: function onChange(item, collapsed) {\n          if (!item) {\n            return false;\n          }\n\n          var data = item.get('model').data;\n          data.collapsed = collapsed;\n          return true;\n        }\n      }, 'default');\n    }\n\n    graph.on('node:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleNodeHover) {\n        handleNodeHover(item, graph);\n      }\n    });\n    graph.on('node:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleNodeUnHover) {\n        handleNodeUnHover(item, graph);\n      }\n    });\n    graph.on('node:click', function (evt) {\n      var item = evt.item,\n          target = evt.target;\n      var targetType = target.get('type');\n      var name = target.get('name'); // 增加元素\n\n      if (targetType === 'marker') {\n        var model = item.getModel();\n\n        if (name === 'add-item') {\n          if (!model.children) {\n            model.children = [];\n          }\n\n          var tmpId = Math.random().toString(36).slice(-8);\n          model.children.push({\n            id: tmpId,\n            label: tmpId\n          });\n          graph.updateChild(model, model.id);\n        } else if (name === 'remove-item') {\n          graph.removeChild(model.id);\n        }\n      } else {\n        if (handleNodeClick) {\n          handleNodeClick(item, graph);\n        }\n      }\n    });\n    graph.on('edge:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleEdgeHover) {\n        handleEdgeHover(item, graph);\n      }\n    });\n    graph.on('edge:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleEdgeUnHover) {\n        handleEdgeUnHover(item, graph);\n      }\n    });\n    graph.on('edge:click', function (evt) {\n      var item = evt.item;\n\n      if (handleEdgeClick) {\n        handleEdgeClick(item, graph);\n      }\n    });\n    graph.on('canvas:click', function (evt) {\n      handleCanvasClick && handleCanvasClick(graph);\n    });\n    return function () {\n      return graph.destroy();\n    };\n  }, []);\n  return React.createElement(ErrorBoundary, null, React.createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: container\n  }));\n};\n\nexport default OrganizationTreeGraphComponent;","map":{"version":3,"sources":["C:/Users/vietn/Desktop/AppEnegry2020/frontend/node_modules/@ant-design/charts/es/graph/organizationTreeGraph.js"],"names":["React","useEffect","G6","ErrorBoundary","customIconNode","getGraphSize","processMinimap","useGraph","defaultStateStyles","hover","stroke","lineWidth","defaultNodeStyle","fill","radius","defaultEdgeStyle","endArrow","path","d","defaultLayout","type","direction","getId","id","getHeight","getWidth","getVGap","getHGap","defaultLabelCfg","style","fontSize","graph","OrganizationTreeGraphComponent","_ref","data","className","width","height","_ref$nodeType","nodeType","_ref$edgeType","edgeType","_ref$collapseExpand","collapseExpand","_ref$nodeSize","nodeSize","_ref$nodeLabelCfg","nodeLabelCfg","_ref$edgeLabelCfg","edgeLabelCfg","_ref$layout","layout","_ref$enableEdit","enableEdit","minimapCfg","_ref$nodeStyle","nodeStyle","_ref$edgeStyle","edgeStyle","_ref$nodeStateStyles","nodeStateStyles","_ref$edgeStateStyles","edgeStateStyles","handleNodeClick","handleEdgeClick","handleNodeHover","handleNodeUnHover","handleEdgeHover","handleEdgeUnHover","handleCanvasClick","graphRef","props","container","useRef","graphSize","destroyed","TreeGraph","current","linkCenter","modes","default","defaultNode","size","labelCfg","defaultEdge","render","fitView","addBehaviors","onChange","item","collapsed","get","on","evt","setItemState","target","targetType","name","model","getModel","children","tmpId","Math","random","toString","slice","push","label","updateChild","removeChild","destroy","createElement","ref"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport G6 from '@antv/g6/es';\nimport { ErrorBoundary } from '../base';\nimport { customIconNode } from './customItems';\nimport { getGraphSize, processMinimap } from './util';\nimport useGraph from '../hooks/useGraph';\nvar defaultStateStyles = {\n  hover: {\n    stroke: '#1890ff',\n    lineWidth: 2\n  }\n};\nvar defaultNodeStyle = {\n  fill: '#91d5ff',\n  stroke: '#40a9ff',\n  radius: 5\n};\nvar defaultEdgeStyle = {\n  stroke: '#91d5ff',\n  endArrow: {\n    path: 'M 0,0 L 12, 6 L 9,0 L 12, -6 Z',\n    fill: '#91d5ff',\n    d: -20\n  }\n};\nvar defaultLayout = {\n  type: 'compactBox',\n  direction: 'TB',\n  getId: function getId(d) {\n    return d.id;\n  },\n  getHeight: function getHeight() {\n    return 16;\n  },\n  getWidth: function getWidth() {\n    return 16;\n  },\n  getVGap: function getVGap() {\n    return 40;\n  },\n  getHGap: function getHGap() {\n    return 70;\n  }\n};\nvar defaultLabelCfg = {\n  style: {\n    fill: '#000',\n    fontSize: 12\n  }\n};\nvar graph;\n\nvar OrganizationTreeGraphComponent = function OrganizationTreeGraphComponent(_ref) {\n  var data = _ref.data,\n      className = _ref.className,\n      style = _ref.style,\n      width = _ref.width,\n      height = _ref.height,\n      _ref$nodeType = _ref.nodeType,\n      nodeType = _ref$nodeType === void 0 ? 'rect' : _ref$nodeType,\n      _ref$edgeType = _ref.edgeType,\n      edgeType = _ref$edgeType === void 0 ? 'flow-line' : _ref$edgeType,\n      _ref$collapseExpand = _ref.collapseExpand,\n      collapseExpand = _ref$collapseExpand === void 0 ? false : _ref$collapseExpand,\n      _ref$nodeSize = _ref.nodeSize,\n      nodeSize = _ref$nodeSize === void 0 ? [120, 40] : _ref$nodeSize,\n      _ref$nodeLabelCfg = _ref.nodeLabelCfg,\n      nodeLabelCfg = _ref$nodeLabelCfg === void 0 ? defaultLabelCfg : _ref$nodeLabelCfg,\n      _ref$edgeLabelCfg = _ref.edgeLabelCfg,\n      edgeLabelCfg = _ref$edgeLabelCfg === void 0 ? defaultLabelCfg : _ref$edgeLabelCfg,\n      _ref$layout = _ref.layout,\n      layout = _ref$layout === void 0 ? defaultLayout : _ref$layout,\n      _ref$enableEdit = _ref.enableEdit,\n      enableEdit = _ref$enableEdit === void 0 ? false : _ref$enableEdit,\n      minimapCfg = _ref.minimapCfg,\n      _ref$nodeStyle = _ref.nodeStyle,\n      nodeStyle = _ref$nodeStyle === void 0 ? defaultNodeStyle : _ref$nodeStyle,\n      _ref$edgeStyle = _ref.edgeStyle,\n      edgeStyle = _ref$edgeStyle === void 0 ? defaultEdgeStyle : _ref$edgeStyle,\n      _ref$nodeStateStyles = _ref.nodeStateStyles,\n      nodeStateStyles = _ref$nodeStateStyles === void 0 ? defaultStateStyles : _ref$nodeStateStyles,\n      _ref$edgeStateStyles = _ref.edgeStateStyles,\n      edgeStateStyles = _ref$edgeStateStyles === void 0 ? defaultStateStyles : _ref$edgeStateStyles,\n      handleNodeClick = _ref.handleNodeClick,\n      handleEdgeClick = _ref.handleEdgeClick,\n      handleNodeHover = _ref.handleNodeHover,\n      handleNodeUnHover = _ref.handleNodeUnHover,\n      handleEdgeHover = _ref.handleEdgeHover,\n      handleEdgeUnHover = _ref.handleEdgeUnHover,\n      handleCanvasClick = _ref.handleCanvasClick,\n      graphRef = _ref.graphRef;\n  var props = {\n    data: data,\n    className: className,\n    style: style,\n    width: width,\n    height: height,\n    nodeType: nodeType,\n    edgeType: edgeType,\n    collapseExpand: collapseExpand,\n    nodeSize: nodeSize,\n    nodeLabelCfg: nodeLabelCfg,\n    edgeLabelCfg: edgeLabelCfg,\n    layout: layout,\n    enableEdit: enableEdit,\n    minimapCfg: minimapCfg,\n    nodeStyle: nodeStyle,\n    edgeStyle: edgeStyle,\n    nodeStateStyles: nodeStateStyles,\n    edgeStateStyles: edgeStateStyles,\n    handleNodeClick: handleNodeClick,\n    handleEdgeClick: handleEdgeClick,\n    handleNodeHover: handleNodeHover,\n    handleNodeUnHover: handleNodeUnHover,\n    handleEdgeHover: handleEdgeHover,\n    handleEdgeUnHover: handleEdgeUnHover,\n    handleCanvasClick: handleCanvasClick,\n    graphRef: graphRef\n  };\n  var container = React.useRef(null);\n  useGraph(graph, props, container);\n  useEffect(function () {\n    var graphSize = getGraphSize(width, height, container);\n\n    if (!graph || graph.destroyed) {\n      if (nodeType === 'icon-node') {\n        customIconNode({\n          enableEdit: enableEdit\n        });\n      }\n\n      graph = new G6.TreeGraph({\n        container: container.current,\n        width: graphSize[0],\n        height: graphSize[1],\n        linkCenter: true,\n        modes: {\n          default: ['drag-canvas', 'zoom-canvas']\n        },\n        defaultNode: {\n          type: nodeType,\n          size: nodeSize,\n          style: nodeStyle,\n          labelCfg: nodeLabelCfg\n        },\n        defaultEdge: {\n          type: edgeType,\n          style: edgeStyle,\n          labelCfg: edgeLabelCfg\n        },\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        layout: layout\n      });\n\n      if (graphRef) {\n        graphRef.current = graph;\n      }\n    }\n\n    processMinimap(minimapCfg, graph);\n    graph.data(data);\n    graph.render();\n    graph.fitView();\n\n    if (collapseExpand) {\n      graph.addBehaviors({\n        type: 'collapse-expand',\n        onChange: function onChange(item, collapsed) {\n          if (!item) {\n            return false;\n          }\n\n          var data = item.get('model').data;\n          data.collapsed = collapsed;\n          return true;\n        }\n      }, 'default');\n    }\n\n    graph.on('node:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleNodeHover) {\n        handleNodeHover(item, graph);\n      }\n    });\n    graph.on('node:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleNodeUnHover) {\n        handleNodeUnHover(item, graph);\n      }\n    });\n    graph.on('node:click', function (evt) {\n      var item = evt.item,\n          target = evt.target;\n      var targetType = target.get('type');\n      var name = target.get('name'); // 增加元素\n\n      if (targetType === 'marker') {\n        var model = item.getModel();\n\n        if (name === 'add-item') {\n          if (!model.children) {\n            model.children = [];\n          }\n\n          var tmpId = Math.random().toString(36).slice(-8);\n          model.children.push({\n            id: tmpId,\n            label: tmpId\n          });\n          graph.updateChild(model, model.id);\n        } else if (name === 'remove-item') {\n          graph.removeChild(model.id);\n        }\n      } else {\n        if (handleNodeClick) {\n          handleNodeClick(item, graph);\n        }\n      }\n    });\n    graph.on('edge:mouseenter', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', true);\n\n      if (handleEdgeHover) {\n        handleEdgeHover(item, graph);\n      }\n    });\n    graph.on('edge:mouseleave', function (evt) {\n      var item = evt.item;\n      graph.setItemState(item, 'hover', false);\n\n      if (handleEdgeUnHover) {\n        handleEdgeUnHover(item, graph);\n      }\n    });\n    graph.on('edge:click', function (evt) {\n      var item = evt.item;\n\n      if (handleEdgeClick) {\n        handleEdgeClick(item, graph);\n      }\n    });\n    graph.on('canvas:click', function (evt) {\n      handleCanvasClick && handleCanvasClick(graph);\n    });\n    return function () {\n      return graph.destroy();\n    };\n  }, []);\n  return React.createElement(ErrorBoundary, null, React.createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: container\n  }));\n};\n\nexport default OrganizationTreeGraphComponent;"]},"metadata":{},"sourceType":"module"}