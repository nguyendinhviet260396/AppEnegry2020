{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport { useRef, useEffect } from 'react';\nimport { utils } from '../util';\nimport createNode from '../util/createNode';\nexport default function useInit(ChartClass, config) {\n  var chart = useRef();\n  var container = useRef(null);\n  /**\n   * Get data base64\n   * @param {string} type A DOMString indicating the image format. The default format type is image/png.\n   * @param {number} encoderOptions A Number between 0 and 1 indicating the image quality\n   */\n\n  var toDataURL = function toDataURL() {\n    var _chart$current;\n\n    var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'image/png';\n    var encoderOptions = arguments.length > 1 ? arguments[1] : undefined;\n    return (_chart$current = chart.current) === null || _chart$current === void 0 ? void 0 : _chart$current.canvas.cfg.el.toDataURL(type, encoderOptions);\n  };\n  /**\n   * Download Iamge\n   * @param {string} name A name of image\n   * @param {string} type A DOMString indicating the image format. The default format type is image/png.\n   * @param {number} encoderOptions A Number between 0 and 1 indicating the image quality\n   */\n\n\n  var downloadImage = function downloadImage(name) {\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'image/png';\n    var encoderOptions = arguments.length > 2 ? arguments[2] : undefined;\n\n    try {\n      var _chart$current2; // default png\n\n\n      if (name && name.indexOf('.') === -1) {\n        name = \"\".concat(name, \".png\");\n      }\n\n      var imageName = name;\n\n      if (!imageName) {\n        var _config$title;\n\n        var _config = config; // 默认值：图表 title -> 图表类型\n\n        imageName = \"\".concat((_config === null || _config === void 0 ? void 0 : (_config$title = _config.title) === null || _config$title === void 0 ? void 0 : _config$title.text) || (ChartClass === null || ChartClass === void 0 ? void 0 : ChartClass.name), \".png\");\n      }\n\n      var base64 = (_chart$current2 = chart.current) === null || _chart$current2 === void 0 ? void 0 : _chart$current2.canvas.cfg.el.toDataURL(type, encoderOptions);\n      var a = document.createElement('a');\n      a.href = base64;\n      a.download = imageName;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      a = null;\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  var processConfig = function processConfig() {\n    var _config$statistic, _config$tooltip, _config$tooltip$custo, _config$tooltip2, _config$tooltip2$cust; // @ts-ignore 该属性只有 Liquid 和 Dount 存在且配置不一致，类型定义先忽略\n\n\n    if ((_config$statistic = config.statistic) === null || _config$statistic === void 0 ? void 0 : _config$statistic.htmlContent) {\n      // @ts-ignore\n      var statisticHtmlContent = config.statistic.htmlContent; // @ts-ignore\n\n      config.statistic.htmlContent = function () {\n        var statisticDom = statisticHtmlContent.apply(void 0, arguments);\n\n        if (utils.isType(statisticDom, 'String') || utils.isType(statisticDom, 'Number') || utils.isType(statisticDom, 'HTMLDivElement')) {\n          return statisticDom;\n        }\n\n        return createNode(statisticDom);\n      };\n    }\n    /* tooltip 支持 ReactNode, 1.0 版本会改用 createPortal  */\n\n\n    if ((_config$tooltip = config.tooltip) === null || _config$tooltip === void 0 ? void 0 : (_config$tooltip$custo = _config$tooltip.custom) === null || _config$tooltip$custo === void 0 ? void 0 : _config$tooltip$custo.container) {\n      config.tooltip.custom.container = createNode(config.tooltip.custom.container);\n    }\n\n    if ((_config$tooltip2 = config.tooltip) === null || _config$tooltip2 === void 0 ? void 0 : (_config$tooltip2$cust = _config$tooltip2.custom) === null || _config$tooltip2$cust === void 0 ? void 0 : _config$tooltip2$cust.customContent) {\n      var customContent = config.tooltip.custom.customContent;\n\n      config.tooltip.custom.customContent = function (title, items) {\n        var tooltipDom = customContent(title, items) || '';\n\n        if (utils.isType(tooltipDom, 'HTMLDivElement')) {\n          return tooltipDom;\n        }\n\n        return createNode(tooltipDom);\n      };\n    }\n  };\n\n  useEffect(function () {\n    if (chart.current) {\n      if (config.onlyChangeData) {\n        chart.current.changeData((config === null || config === void 0 ? void 0 : config.data) || []);\n      } else {\n        processConfig();\n        chart.current.updateConfig(config);\n        chart.current.render();\n      }\n    } // 比对方法已更新，请查看 v2 分支\n\n  }, [(config === null || config === void 0 ? void 0 : config.memoData) ? config.memoData : JSON.stringify(config)]);\n  useEffect(function () {\n    if (!container.current) {\n      return function () {\n        return null;\n      };\n    }\n\n    processConfig();\n    var chartInstance = new ChartClass(container.current, _objectSpread({}, config));\n\n    chartInstance.__proto__.toDataURL = function (type, encoderOptions) {\n      return toDataURL(type, encoderOptions);\n    };\n\n    chartInstance.__proto__.downloadImage = function (name, type, encoderOptions) {\n      return downloadImage(name, type, encoderOptions);\n    };\n\n    chartInstance.render();\n    chart.current = utils.clone(chartInstance);\n    return function () {\n      return chartInstance.destroy();\n    };\n  }, []);\n  return {\n    chart: chart,\n    container: container,\n    toDataURL: toDataURL,\n    downloadImage: downloadImage\n  };\n}","map":{"version":3,"sources":["C:/Users/vietn/Desktop/AppEnegry2020/frontend/node_modules/@ant-design/charts/es/hooks/useChart.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","useRef","useEffect","utils","createNode","useInit","ChartClass","config","chart","container","toDataURL","_chart$current","type","undefined","encoderOptions","current","canvas","cfg","el","downloadImage","name","_chart$current2","indexOf","concat","imageName","_config$title","_config","title","text","base64","a","document","createElement","href","download","body","appendChild","click","removeChild","err","console","log","processConfig","_config$statistic","_config$tooltip","_config$tooltip$custo","_config$tooltip2","_config$tooltip2$cust","statistic","htmlContent","statisticHtmlContent","statisticDom","isType","tooltip","custom","customContent","items","tooltipDom","onlyChangeData","changeData","data","updateConfig","render","memoData","JSON","stringify","chartInstance","__proto__","clone","destroy"],"mappings":"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","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useRef, useEffect } from 'react';\nimport { utils } from '../util';\nimport createNode from '../util/createNode';\nexport default function useInit(ChartClass, config) {\n  var chart = useRef();\n  var container = useRef(null);\n  /**\n   * Get data base64\n   * @param {string} type A DOMString indicating the image format. The default format type is image/png.\n   * @param {number} encoderOptions A Number between 0 and 1 indicating the image quality\n   */\n\n  var toDataURL = function toDataURL() {\n    var _chart$current;\n\n    var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'image/png';\n    var encoderOptions = arguments.length > 1 ? arguments[1] : undefined;\n    return (_chart$current = chart.current) === null || _chart$current === void 0 ? void 0 : _chart$current.canvas.cfg.el.toDataURL(type, encoderOptions);\n  };\n  /**\n   * Download Iamge\n   * @param {string} name A name of image\n   * @param {string} type A DOMString indicating the image format. The default format type is image/png.\n   * @param {number} encoderOptions A Number between 0 and 1 indicating the image quality\n   */\n\n\n  var downloadImage = function downloadImage(name) {\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'image/png';\n    var encoderOptions = arguments.length > 2 ? arguments[2] : undefined;\n\n    try {\n      var _chart$current2;\n\n      // default png\n      if (name && name.indexOf('.') === -1) {\n        name = \"\".concat(name, \".png\");\n      }\n\n      var imageName = name;\n\n      if (!imageName) {\n        var _config$title;\n\n        var _config = config; // 默认值：图表 title -> 图表类型\n\n        imageName = \"\".concat((_config === null || _config === void 0 ? void 0 : (_config$title = _config.title) === null || _config$title === void 0 ? void 0 : _config$title.text) || (ChartClass === null || ChartClass === void 0 ? void 0 : ChartClass.name), \".png\");\n      }\n\n      var base64 = (_chart$current2 = chart.current) === null || _chart$current2 === void 0 ? void 0 : _chart$current2.canvas.cfg.el.toDataURL(type, encoderOptions);\n      var a = document.createElement('a');\n      a.href = base64;\n      a.download = imageName;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      a = null;\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  var processConfig = function processConfig() {\n    var _config$statistic, _config$tooltip, _config$tooltip$custo, _config$tooltip2, _config$tooltip2$cust;\n\n    // @ts-ignore 该属性只有 Liquid 和 Dount 存在且配置不一致，类型定义先忽略\n    if ((_config$statistic = config.statistic) === null || _config$statistic === void 0 ? void 0 : _config$statistic.htmlContent) {\n      // @ts-ignore\n      var statisticHtmlContent = config.statistic.htmlContent; // @ts-ignore\n\n      config.statistic.htmlContent = function () {\n        var statisticDom = statisticHtmlContent.apply(void 0, arguments);\n\n        if (utils.isType(statisticDom, 'String') || utils.isType(statisticDom, 'Number') || utils.isType(statisticDom, 'HTMLDivElement')) {\n          return statisticDom;\n        }\n\n        return createNode(statisticDom);\n      };\n    }\n    /* tooltip 支持 ReactNode, 1.0 版本会改用 createPortal  */\n\n\n    if ((_config$tooltip = config.tooltip) === null || _config$tooltip === void 0 ? void 0 : (_config$tooltip$custo = _config$tooltip.custom) === null || _config$tooltip$custo === void 0 ? void 0 : _config$tooltip$custo.container) {\n      config.tooltip.custom.container = createNode(config.tooltip.custom.container);\n    }\n\n    if ((_config$tooltip2 = config.tooltip) === null || _config$tooltip2 === void 0 ? void 0 : (_config$tooltip2$cust = _config$tooltip2.custom) === null || _config$tooltip2$cust === void 0 ? void 0 : _config$tooltip2$cust.customContent) {\n      var customContent = config.tooltip.custom.customContent;\n\n      config.tooltip.custom.customContent = function (title, items) {\n        var tooltipDom = customContent(title, items) || '';\n\n        if (utils.isType(tooltipDom, 'HTMLDivElement')) {\n          return tooltipDom;\n        }\n\n        return createNode(tooltipDom);\n      };\n    }\n  };\n\n  useEffect(function () {\n    if (chart.current) {\n      if (config.onlyChangeData) {\n        chart.current.changeData((config === null || config === void 0 ? void 0 : config.data) || []);\n      } else {\n        processConfig();\n        chart.current.updateConfig(config);\n        chart.current.render();\n      }\n    } // 比对方法已更新，请查看 v2 分支\n\n  }, [(config === null || config === void 0 ? void 0 : config.memoData) ? config.memoData : JSON.stringify(config)]);\n  useEffect(function () {\n    if (!container.current) {\n      return function () {\n        return null;\n      };\n    }\n\n    processConfig();\n    var chartInstance = new ChartClass(container.current, _objectSpread({}, config));\n\n    chartInstance.__proto__.toDataURL = function (type, encoderOptions) {\n      return toDataURL(type, encoderOptions);\n    };\n\n    chartInstance.__proto__.downloadImage = function (name, type, encoderOptions) {\n      return downloadImage(name, type, encoderOptions);\n    };\n\n    chartInstance.render();\n    chart.current = utils.clone(chartInstance);\n    return function () {\n      return chartInstance.destroy();\n    };\n  }, []);\n  return {\n    chart: chart,\n    container: container,\n    toDataURL: toDataURL,\n    downloadImage: downloadImage\n  };\n}"]},"metadata":{},"sourceType":"module"}