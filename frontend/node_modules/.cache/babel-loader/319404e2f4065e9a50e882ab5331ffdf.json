{"ast":null,"code":"import { each, mix } from '@antv/util';\nimport { compare } from '../../base/controller/state'; // 对label和label样式进行缓存\n\nvar labels;\nvar originAttrs;\n\nfunction onActive(plot, condition) {\n  if (!labels) {\n    getAllLabels(plot);\n  }\n\n  each(labels, function (label, index) {\n    var origin = label.get('origin');\n\n    if (compare(origin, condition)) {\n      var originAttr = originAttrs[index];\n      var style = mix({}, originAttr, {\n        opacity: 1\n      });\n      label.attr(style);\n    }\n  });\n}\n\nfunction onDisable(plot, condition) {\n  if (!labels) {\n    getAllLabels(plot);\n  }\n\n  each(labels, function (label, index) {\n    var origin = label.get('origin');\n\n    if (compare(origin, condition)) {\n      var originAttr = originAttrs[index];\n      var disableStyle = labelDisableStyle(originAttr);\n      label.attr(disableStyle);\n    }\n  });\n}\n\nfunction getAllLabels(plot) {\n  labels = [];\n  originAttrs = [];\n  var geoms = plot.view.get('elements');\n  each(geoms, function (geom) {\n    var geomLabels = geom.get('labels');\n\n    if (geomLabels) {\n      each(geomLabels, function (label) {\n        labels.push(label);\n        originAttrs.push(label.attr());\n      });\n    }\n  });\n}\n\nfunction labelDisableStyle(style) {\n  var opacity = style.opacity || 1;\n  return {\n    opacity: opacity * 0.2\n  };\n}\n\nexport default {\n  active: onActive,\n  selected: onActive,\n  disable: onDisable\n};","map":{"version":3,"sources":["../../../src/components/label/state.ts"],"names":[],"mappings":"AAAA,SAAS,IAAT,EAAe,GAAf,QAA0B,YAA1B;AACA,SAAS,OAAT,QAAwB,6BAAxB,C,CAEA;;AACA,IAAI,MAAJ;AACA,IAAI,WAAJ;;AAEA,SAAS,QAAT,CAAkB,IAAlB,EAAwB,SAAxB,EAAiC;AAC/B,MAAI,CAAC,MAAL,EAAa;AACX,IAAA,YAAY,CAAC,IAAD,CAAZ;AACD;;AACD,EAAA,IAAI,CAAC,MAAD,EAAS,UAAC,KAAD,EAAQ,KAAR,EAAa;AACxB,QAAM,MAAM,GAAG,KAAK,CAAC,GAAN,CAAU,QAAV,CAAf;;AACA,QAAI,OAAO,CAAC,MAAD,EAAS,SAAT,CAAX,EAAgC;AAC9B,UAAM,UAAU,GAAG,WAAW,CAAC,KAAD,CAA9B;AACA,UAAM,KAAK,GAAG,GAAG,CAAC,EAAD,EAAK,UAAL,EAAiB;AAAE,QAAA,OAAO,EAAE;AAAX,OAAjB,CAAjB;AACA,MAAA,KAAK,CAAC,IAAN,CAAW,KAAX;AACD;AACF,GAPG,CAAJ;AAQD;;AAED,SAAS,SAAT,CAAmB,IAAnB,EAAyB,SAAzB,EAAkC;AAChC,MAAI,CAAC,MAAL,EAAa;AACX,IAAA,YAAY,CAAC,IAAD,CAAZ;AACD;;AACD,EAAA,IAAI,CAAC,MAAD,EAAS,UAAC,KAAD,EAAQ,KAAR,EAAa;AACxB,QAAM,MAAM,GAAG,KAAK,CAAC,GAAN,CAAU,QAAV,CAAf;;AACA,QAAI,OAAO,CAAC,MAAD,EAAS,SAAT,CAAX,EAAgC;AAC9B,UAAM,UAAU,GAAG,WAAW,CAAC,KAAD,CAA9B;AACA,UAAM,YAAY,GAAG,iBAAiB,CAAC,UAAD,CAAtC;AACA,MAAA,KAAK,CAAC,IAAN,CAAW,YAAX;AACD;AACF,GAPG,CAAJ;AAQD;;AAED,SAAS,YAAT,CAAsB,IAAtB,EAA0B;AACxB,EAAA,MAAM,GAAG,EAAT;AACA,EAAA,WAAW,GAAG,EAAd;AACA,MAAM,KAAK,GAAG,IAAI,CAAC,IAAL,CAAU,GAAV,CAAc,UAAd,CAAd;AACA,EAAA,IAAI,CAAC,KAAD,EAAQ,UAAC,IAAD,EAAK;AACf,QAAM,UAAU,GAAG,IAAI,CAAC,GAAL,CAAS,QAAT,CAAnB;;AACA,QAAI,UAAJ,EAAgB;AACd,MAAA,IAAI,CAAC,UAAD,EAAa,UAAC,KAAD,EAAM;AACrB,QAAA,MAAM,CAAC,IAAP,CAAY,KAAZ;AACA,QAAA,WAAW,CAAC,IAAZ,CAAiB,KAAK,CAAC,IAAN,EAAjB;AACD,OAHG,CAAJ;AAID;AACF,GARG,CAAJ;AASD;;AAED,SAAS,iBAAT,CAA2B,KAA3B,EAAgC;AAC9B,MAAM,OAAO,GAAG,KAAK,CAAC,OAAN,IAAiB,CAAjC;AACA,SAAO;AAAE,IAAA,OAAO,EAAE,OAAO,GAAG;AAArB,GAAP;AACD;;AAED,eAAe;AACb,EAAA,MAAM,EAAE,QADK;AAEb,EAAA,QAAQ,EAAE,QAFG;AAGb,EAAA,OAAO,EAAE;AAHI,CAAf","sourcesContent":["import { each, mix } from '@antv/util';\nimport { compare } from '../../base/controller/state';\n\n// 对label和label样式进行缓存\nlet labels;\nlet originAttrs;\n\nfunction onActive(plot, condition) {\n  if (!labels) {\n    getAllLabels(plot);\n  }\n  each(labels, (label, index) => {\n    const origin = label.get('origin');\n    if (compare(origin, condition)) {\n      const originAttr = originAttrs[index];\n      const style = mix({}, originAttr, { opacity: 1 });\n      label.attr(style);\n    }\n  });\n}\n\nfunction onDisable(plot, condition) {\n  if (!labels) {\n    getAllLabels(plot);\n  }\n  each(labels, (label, index) => {\n    const origin = label.get('origin');\n    if (compare(origin, condition)) {\n      const originAttr = originAttrs[index];\n      const disableStyle = labelDisableStyle(originAttr);\n      label.attr(disableStyle);\n    }\n  });\n}\n\nfunction getAllLabels(plot) {\n  labels = [];\n  originAttrs = [];\n  const geoms = plot.view.get('elements');\n  each(geoms, (geom) => {\n    const geomLabels = geom.get('labels');\n    if (geomLabels) {\n      each(geomLabels, (label) => {\n        labels.push(label);\n        originAttrs.push(label.attr());\n      });\n    }\n  });\n}\n\nfunction labelDisableStyle(style) {\n  const opacity = style.opacity || 1;\n  return { opacity: opacity * 0.2 };\n}\n\nexport default {\n  active: onActive,\n  selected: onActive,\n  disable: onDisable,\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}