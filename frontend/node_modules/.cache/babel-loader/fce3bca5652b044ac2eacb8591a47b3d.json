{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getTextPoint = exports.toPx = exports.updateClip = exports.getBBoxWithClip = exports.mergeBBox = exports.intersectBBox = exports.near = exports.wait = exports.distance = exports.getCirclePoint = exports.getValueByPercent = exports.createBBox = exports.pointsToBBox = exports.regionToBBox = exports.hasClass = exports.clearDom = exports.formatPadding = void 0;\n\nvar util_1 = require(\"@antv/util\");\n\nfunction formatPadding(padding) {\n  var top = 0;\n  var left = 0;\n  var right = 0;\n  var bottom = 0;\n\n  if (util_1.isNumber(padding)) {\n    top = left = right = bottom = padding;\n  } else if (util_1.isArray(padding)) {\n    top = padding[0];\n    right = !util_1.isNil(padding[1]) ? padding[1] : padding[0];\n    bottom = !util_1.isNil(padding[2]) ? padding[2] : padding[0];\n    left = !util_1.isNil(padding[3]) ? padding[3] : right;\n  }\n\n  return [top, right, bottom, left];\n}\n\nexports.formatPadding = formatPadding;\n\nfunction clearDom(container) {\n  var children = container.childNodes;\n  var length = children.length;\n\n  for (var i = length - 1; i >= 0; i--) {\n    container.removeChild(children[i]);\n  }\n}\n\nexports.clearDom = clearDom;\n\nfunction hasClass(elements, cName) {\n  return !!elements.className.match(new RegExp(\"(\\\\s|^)\" + cName + \"(\\\\s|$)\"));\n}\n\nexports.hasClass = hasClass;\n\nfunction regionToBBox(region) {\n  var start = region.start,\n      end = region.end;\n  var minX = Math.min(start.x, end.x);\n  var minY = Math.min(start.y, end.y);\n  var maxX = Math.max(start.x, end.x);\n  var maxY = Math.max(start.y, end.y);\n  return {\n    x: minX,\n    y: minY,\n    minX: minX,\n    minY: minY,\n    maxX: maxX,\n    maxY: maxY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\n\nexports.regionToBBox = regionToBBox;\n\nfunction pointsToBBox(points) {\n  var xs = points.map(function (point) {\n    return point.x;\n  });\n  var ys = points.map(function (point) {\n    return point.y;\n  });\n  var minX = Math.min.apply(Math, xs);\n  var minY = Math.min.apply(Math, ys);\n  var maxX = Math.max.apply(Math, xs);\n  var maxY = Math.max.apply(Math, ys);\n  return {\n    x: minX,\n    y: minY,\n    minX: minX,\n    minY: minY,\n    maxX: maxX,\n    maxY: maxY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\n\nexports.pointsToBBox = pointsToBBox;\n\nfunction createBBox(x, y, width, height) {\n  return {\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n    minX: x,\n    minY: y,\n    maxX: x + width,\n    maxY: y + height\n  };\n}\n\nexports.createBBox = createBBox;\n\nfunction getValueByPercent(min, max, percent) {\n  return (1 - percent) * min + max * percent;\n}\n\nexports.getValueByPercent = getValueByPercent;\n\nfunction getCirclePoint(center, radius, angle) {\n  return {\n    x: center.x + Math.cos(angle) * radius,\n    y: center.y + Math.sin(angle) * radius\n  };\n}\n\nexports.getCirclePoint = getCirclePoint;\n\nfunction distance(p1, p2) {\n  var dx = p2.x - p1.x;\n  var dy = p2.y - p1.y;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nexports.distance = distance;\n\nexports.wait = function (interval) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, interval);\n  });\n};\n\nexports.near = function (x, y) {\n  return [x, y].includes(Infinity) ? Math.abs(x) === Math.abs(y) : Math.abs(x - y) < Math.pow(Number.EPSILON, 0.5);\n};\n\nfunction intersectBBox(box1, box2) {\n  var minX = Math.max(box1.minX, box2.minX);\n  var minY = Math.max(box1.minY, box2.minY);\n  var maxX = Math.min(box1.maxX, box2.maxX);\n  var maxY = Math.min(box1.maxY, box2.maxY);\n  return createBBox(minX, minY, maxX - minX, maxY - minY);\n}\n\nexports.intersectBBox = intersectBBox;\n\nfunction mergeBBox(box1, box2) {\n  var minX = Math.min(box1.minX, box2.minX);\n  var minY = Math.min(box1.minY, box2.minY);\n  var maxX = Math.max(box1.maxX, box2.maxX);\n  var maxY = Math.max(box1.maxY, box2.maxY);\n  return createBBox(minX, minY, maxX - minX, maxY - minY);\n}\n\nexports.mergeBBox = mergeBBox;\n\nfunction getBBoxWithClip(element) {\n  var clipShape = element.getClip();\n  var clipBBox = clipShape && clipShape.getBBox();\n  var bbox;\n\n  if (!element.isGroup()) {\n    // 如果是普通的图形\n    bbox = element.getBBox();\n  } else {\n    var minX_1 = Infinity;\n    var maxX_1 = -Infinity;\n    var minY_1 = Infinity;\n    var maxY_1 = -Infinity;\n    var children = element.getChildren();\n\n    if (children.length > 0) {\n      util_1.each(children, function (child) {\n        if (child.get('visible')) {\n          // 如果分组没有子元素，则直接跳过\n          if (child.isGroup() && child.get('children').length === 0) {\n            return true;\n          }\n\n          var box = getBBoxWithClip(child); // 计算 4 个顶点\n\n          var leftTop = child.applyToMatrix([box.minX, box.minY, 1]);\n          var leftBottom = child.applyToMatrix([box.minX, box.maxY, 1]);\n          var rightTop = child.applyToMatrix([box.maxX, box.minY, 1]);\n          var rightBottom = child.applyToMatrix([box.maxX, box.maxY, 1]); // 从中取最小的范围\n\n          var boxMinX = Math.min(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\n          var boxMaxX = Math.max(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\n          var boxMinY = Math.min(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\n          var boxMaxY = Math.max(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\n\n          if (boxMinX < minX_1) {\n            minX_1 = boxMinX;\n          }\n\n          if (boxMaxX > maxX_1) {\n            maxX_1 = boxMaxX;\n          }\n\n          if (boxMinY < minY_1) {\n            minY_1 = boxMinY;\n          }\n\n          if (boxMaxY > maxY_1) {\n            maxY_1 = boxMaxY;\n          }\n        }\n      });\n    } else {\n      minX_1 = 0;\n      maxX_1 = 0;\n      minY_1 = 0;\n      maxY_1 = 0;\n    }\n\n    bbox = createBBox(minX_1, minY_1, maxX_1 - minX_1, maxY_1 - minY_1);\n  }\n\n  if (clipBBox) {\n    return intersectBBox(bbox, clipBBox);\n  } else {\n    return bbox;\n  }\n}\n\nexports.getBBoxWithClip = getBBoxWithClip;\n\nfunction updateClip(element, newElement) {\n  if (!element.getClip() && !newElement.getClip()) {\n    // 两者都没有 clip\n    return;\n  }\n\n  var newClipShape = newElement.getClip();\n\n  if (!newClipShape) {\n    // 新的 element 没有 clip\n    element.setClip(null); // 移除 clip\n\n    return;\n  }\n\n  var clipCfg = {\n    type: newClipShape.get('type'),\n    attrs: newClipShape.attr()\n  };\n  element.setClip(clipCfg);\n}\n\nexports.updateClip = updateClip;\n\nfunction toPx(number) {\n  return number + \"px\";\n}\n\nexports.toPx = toPx;\n\nfunction getTextPoint(start, end, position, offset) {\n  var lineLength = distance(start, end);\n  var offsetPercent = offset / lineLength; // 计算间距同线的比例，用于计算最终的位置\n\n  var percent = 0;\n\n  if (position === 'start') {\n    percent = 0 - offsetPercent;\n  } else if (position === 'end') {\n    percent = 1 + offsetPercent;\n  }\n\n  return {\n    x: getValueByPercent(start.x, end.x, percent),\n    y: getValueByPercent(start.y, end.y, percent)\n  };\n}\n\nexports.getTextPoint = getTextPoint;","map":{"version":3,"sources":["../../src/util/util.ts"],"names":[],"mappings":";;;;;;;AACA,IAAA,MAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AAGA,SAAgB,aAAhB,CAA8B,OAA9B,EAAwD;AACtD,MAAI,GAAG,GAAG,CAAV;AACA,MAAI,IAAI,GAAG,CAAX;AACA,MAAI,KAAK,GAAG,CAAZ;AACA,MAAI,MAAM,GAAG,CAAb;;AAEA,MAAI,MAAA,CAAA,QAAA,CAAS,OAAT,CAAJ,EAAuB;AACrB,IAAA,GAAG,GAAG,IAAI,GAAG,KAAK,GAAG,MAAM,GAAG,OAA9B;AACD,GAFD,MAEO,IAAI,MAAA,CAAA,OAAA,CAAQ,OAAR,CAAJ,EAAsB;AAC3B,IAAA,GAAG,GAAG,OAAO,CAAC,CAAD,CAAb;AACA,IAAA,KAAK,GAAG,CAAC,MAAA,CAAA,KAAA,CAAM,OAAO,CAAC,CAAD,CAAb,CAAD,GAAqB,OAAO,CAAC,CAAD,CAA5B,GAAkC,OAAO,CAAC,CAAD,CAAjD;AACA,IAAA,MAAM,GAAG,CAAC,MAAA,CAAA,KAAA,CAAM,OAAO,CAAC,CAAD,CAAb,CAAD,GAAqB,OAAO,CAAC,CAAD,CAA5B,GAAkC,OAAO,CAAC,CAAD,CAAlD;AACA,IAAA,IAAI,GAAG,CAAC,MAAA,CAAA,KAAA,CAAM,OAAO,CAAC,CAAD,CAAb,CAAD,GAAqB,OAAO,CAAC,CAAD,CAA5B,GAAkC,KAAzC;AACD;;AAED,SAAO,CAAC,GAAD,EAAM,KAAN,EAAa,MAAb,EAAqB,IAArB,CAAP;AACD;;AAhBD,OAAA,CAAA,aAAA,GAAA,aAAA;;AAkBA,SAAgB,QAAhB,CAAyB,SAAzB,EAA+C;AAC7C,MAAM,QAAQ,GAAG,SAAS,CAAC,UAA3B;AACA,MAAM,MAAM,GAAG,QAAQ,CAAC,MAAxB;;AACA,OAAK,IAAI,CAAC,GAAG,MAAM,GAAG,CAAtB,EAAyB,CAAC,IAAI,CAA9B,EAAiC,CAAC,EAAlC,EAAsC;AACpC,IAAA,SAAS,CAAC,WAAV,CAAsB,QAAQ,CAAC,CAAD,CAA9B;AACD;AACF;;AAND,OAAA,CAAA,QAAA,GAAA,QAAA;;AAQA,SAAgB,QAAhB,CAAyB,QAAzB,EAAmC,KAAnC,EAAwC;AACtC,SAAO,CAAC,CAAC,QAAQ,CAAC,SAAT,CAAmB,KAAnB,CAAyB,IAAI,MAAJ,CAAW,YAAU,KAAV,GAAe,SAA1B,CAAzB,CAAT;AACD;;AAFD,OAAA,CAAA,QAAA,GAAA,QAAA;;AAIA,SAAgB,YAAhB,CAA6B,MAA7B,EAA2C;AACjC,MAAA,KAAK,GAAU,MAAM,CAAhB,KAAL;AAAA,MAAO,GAAG,GAAK,MAAM,CAAX,GAAV;AACR,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,KAAK,CAAC,CAAf,EAAkB,GAAG,CAAC,CAAtB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,KAAK,CAAC,CAAf,EAAkB,GAAG,CAAC,CAAtB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,KAAK,CAAC,CAAf,EAAkB,GAAG,CAAC,CAAtB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,KAAK,CAAC,CAAf,EAAkB,GAAG,CAAC,CAAtB,CAAb;AACA,SAAO;AACL,IAAA,CAAC,EAAE,IADE;AAEL,IAAA,CAAC,EAAE,IAFE;AAGL,IAAA,IAAI,EAAA,IAHC;AAIL,IAAA,IAAI,EAAA,IAJC;AAKL,IAAA,IAAI,EAAA,IALC;AAML,IAAA,IAAI,EAAA,IANC;AAOL,IAAA,KAAK,EAAE,IAAI,GAAG,IAPT;AAQL,IAAA,MAAM,EAAE,IAAI,GAAG;AARV,GAAP;AAUD;;AAhBD,OAAA,CAAA,YAAA,GAAA,YAAA;;AAkBA,SAAgB,YAAhB,CAA6B,MAA7B,EAA4C;AAC1C,MAAM,EAAE,GAAa,MAAM,CAAC,GAAP,CAAW,UAAC,KAAD,EAAM;AAAK,WAAA,KAAK,CAAL,CAAA;AAAO,GAA7B,CAArB;AACA,MAAM,EAAE,GAAa,MAAM,CAAC,GAAP,CAAW,UAAC,KAAD,EAAM;AAAK,WAAA,KAAK,CAAL,CAAA;AAAO,GAA7B,CAArB;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAQ,KAAR,CAAA,IAAA,EAAY,EAAZ,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAQ,KAAR,CAAA,IAAA,EAAY,EAAZ,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAQ,KAAR,CAAA,IAAA,EAAY,EAAZ,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAQ,KAAR,CAAA,IAAA,EAAY,EAAZ,CAAb;AACA,SAAO;AACL,IAAA,CAAC,EAAE,IADE;AAEL,IAAA,CAAC,EAAE,IAFE;AAGL,IAAA,IAAI,EAAA,IAHC;AAIL,IAAA,IAAI,EAAA,IAJC;AAKL,IAAA,IAAI,EAAA,IALC;AAML,IAAA,IAAI,EAAA,IANC;AAOL,IAAA,KAAK,EAAE,IAAI,GAAG,IAPT;AAQL,IAAA,MAAM,EAAE,IAAI,GAAG;AARV,GAAP;AAUD;;AAjBD,OAAA,CAAA,YAAA,GAAA,YAAA;;AAmBA,SAAgB,UAAhB,CAA2B,CAA3B,EAAsC,CAAtC,EAAiD,KAAjD,EAAgE,MAAhE,EAA8E;AAC5E,SAAO;AACL,IAAA,CAAC,EAAA,CADI;AAEL,IAAA,CAAC,EAAA,CAFI;AAGL,IAAA,KAAK,EAAA,KAHA;AAIL,IAAA,MAAM,EAAA,MAJD;AAKL,IAAA,IAAI,EAAE,CALD;AAML,IAAA,IAAI,EAAE,CAND;AAOL,IAAA,IAAI,EAAE,CAAC,GAAG,KAPL;AAQL,IAAA,IAAI,EAAE,CAAC,GAAG;AARL,GAAP;AAUD;;AAXD,OAAA,CAAA,UAAA,GAAA,UAAA;;AAaA,SAAgB,iBAAhB,CAAkC,GAAlC,EAA+C,GAA/C,EAA4D,OAA5D,EAA2E;AACzE,SAAO,CAAC,IAAI,OAAL,IAAgB,GAAhB,GAAsB,GAAG,GAAG,OAAnC;AACD;;AAFD,OAAA,CAAA,iBAAA,GAAA,iBAAA;;AAIA,SAAgB,cAAhB,CAA+B,MAA/B,EAA8C,MAA9C,EAA8D,KAA9D,EAA2E;AACzE,SAAO;AACL,IAAA,CAAC,EAAE,MAAM,CAAC,CAAP,GAAW,IAAI,CAAC,GAAL,CAAS,KAAT,IAAkB,MAD3B;AAEL,IAAA,CAAC,EAAE,MAAM,CAAC,CAAP,GAAW,IAAI,CAAC,GAAL,CAAS,KAAT,IAAkB;AAF3B,GAAP;AAID;;AALD,OAAA,CAAA,cAAA,GAAA,cAAA;;AAOA,SAAgB,QAAhB,CAAyB,EAAzB,EAAoC,EAApC,EAA6C;AAC3C,MAAM,EAAE,GAAG,EAAE,CAAC,CAAH,GAAO,EAAE,CAAC,CAArB;AACA,MAAM,EAAE,GAAG,EAAE,CAAC,CAAH,GAAO,EAAE,CAAC,CAArB;AACA,SAAO,IAAI,CAAC,IAAL,CAAU,EAAE,GAAG,EAAL,GAAU,EAAE,GAAG,EAAzB,CAAP;AACD;;AAJD,OAAA,CAAA,QAAA,GAAA,QAAA;;AAMa,OAAA,CAAA,IAAA,GAAO,UAAC,QAAD,EAAiB;AACnC,SAAO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAQ;AACzB,IAAA,UAAU,CAAC,OAAD,EAAU,QAAV,CAAV;AACD,GAFM,CAAP;AAGD,CAJY;;AAMA,OAAA,CAAA,IAAA,GAAO,UAAC,CAAD,EAAY,CAAZ,EAAqB;AACvC,SAAA,CAAC,CAAD,EAAI,CAAJ,EAAO,QAAP,CAAgB,QAAhB,IAA4B,IAAI,CAAC,GAAL,CAAS,CAAT,MAAgB,IAAI,CAAC,GAAL,CAAS,CAAT,CAA5C,GAA0D,IAAI,CAAC,GAAL,CAAS,CAAC,GAAG,CAAb,IAAkB,IAAI,CAAC,GAAL,CAAS,MAAM,CAAC,OAAhB,EAAyB,GAAzB,CAA5E;AAAyG,CAD9F;;AAGb,SAAgB,aAAhB,CAA8B,IAA9B,EAA0C,IAA1C,EAAoD;AAClD,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,SAAO,UAAU,CAAC,IAAD,EAAO,IAAP,EAAa,IAAI,GAAG,IAApB,EAA0B,IAAI,GAAG,IAAjC,CAAjB;AACD;;AAND,OAAA,CAAA,aAAA,GAAA,aAAA;;AAQA,SAAgB,SAAhB,CAA0B,IAA1B,EAAsC,IAAtC,EAAgD;AAC9C,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,IAAd,EAAoB,IAAI,CAAC,IAAzB,CAAb;AACA,SAAO,UAAU,CAAC,IAAD,EAAO,IAAP,EAAa,IAAI,GAAG,IAApB,EAA0B,IAAI,GAAG,IAAjC,CAAjB;AACD;;AAND,OAAA,CAAA,SAAA,GAAA,SAAA;;AAQA,SAAgB,eAAhB,CAAgC,OAAhC,EAAiD;AAC/C,MAAM,SAAS,GAAG,OAAO,CAAC,OAAR,EAAlB;AACA,MAAM,QAAQ,GAAG,SAAS,IAAI,SAAS,CAAC,OAAV,EAA9B;AACA,MAAI,IAAJ;;AACA,MAAI,CAAC,OAAO,CAAC,OAAR,EAAL,EAAwB;AACtB;AACA,IAAA,IAAI,GAAG,OAAO,CAAC,OAAR,EAAP;AACD,GAHD,MAGO;AACL,QAAI,MAAI,GAAG,QAAX;AACA,QAAI,MAAI,GAAG,CAAC,QAAZ;AACA,QAAI,MAAI,GAAG,QAAX;AACA,QAAI,MAAI,GAAG,CAAC,QAAZ;AACA,QAAM,QAAQ,GAAI,OAAkB,CAAC,WAAnB,EAAlB;;AACA,QAAI,QAAQ,CAAC,MAAT,GAAkB,CAAtB,EAAyB;AACvB,MAAA,MAAA,CAAA,IAAA,CAAK,QAAL,EAAe,UAAC,KAAD,EAAgB;AAC7B,YAAI,KAAK,CAAC,GAAN,CAAU,SAAV,CAAJ,EAA0B;AACxB;AACA,cAAI,KAAK,CAAC,OAAN,MAAmB,KAAK,CAAC,GAAN,CAAU,UAAV,EAAsB,MAAtB,KAAiC,CAAxD,EAA2D;AACzD,mBAAO,IAAP;AACD;;AACD,cAAM,GAAG,GAAG,eAAe,CAAC,KAAD,CAA3B,CALwB,CAMxB;;AACA,cAAM,OAAO,GAAG,KAAK,CAAC,aAAN,CAAoB,CAAC,GAAG,CAAC,IAAL,EAAW,GAAG,CAAC,IAAf,EAAqB,CAArB,CAApB,CAAhB;AACA,cAAM,UAAU,GAAG,KAAK,CAAC,aAAN,CAAoB,CAAC,GAAG,CAAC,IAAL,EAAW,GAAG,CAAC,IAAf,EAAqB,CAArB,CAApB,CAAnB;AACA,cAAM,QAAQ,GAAG,KAAK,CAAC,aAAN,CAAoB,CAAC,GAAG,CAAC,IAAL,EAAW,GAAG,CAAC,IAAf,EAAqB,CAArB,CAApB,CAAjB;AACA,cAAM,WAAW,GAAG,KAAK,CAAC,aAAN,CAAoB,CAAC,GAAG,CAAC,IAAL,EAAW,GAAG,CAAC,IAAf,EAAqB,CAArB,CAApB,CAApB,CAVwB,CAWxB;;AACA,cAAM,OAAO,GAAG,IAAI,CAAC,GAAL,CAAS,OAAO,CAAC,CAAD,CAAhB,EAAqB,UAAU,CAAC,CAAD,CAA/B,EAAoC,QAAQ,CAAC,CAAD,CAA5C,EAAiD,WAAW,CAAC,CAAD,CAA5D,CAAhB;AACA,cAAM,OAAO,GAAG,IAAI,CAAC,GAAL,CAAS,OAAO,CAAC,CAAD,CAAhB,EAAqB,UAAU,CAAC,CAAD,CAA/B,EAAoC,QAAQ,CAAC,CAAD,CAA5C,EAAiD,WAAW,CAAC,CAAD,CAA5D,CAAhB;AACA,cAAM,OAAO,GAAG,IAAI,CAAC,GAAL,CAAS,OAAO,CAAC,CAAD,CAAhB,EAAqB,UAAU,CAAC,CAAD,CAA/B,EAAoC,QAAQ,CAAC,CAAD,CAA5C,EAAiD,WAAW,CAAC,CAAD,CAA5D,CAAhB;AACA,cAAM,OAAO,GAAG,IAAI,CAAC,GAAL,CAAS,OAAO,CAAC,CAAD,CAAhB,EAAqB,UAAU,CAAC,CAAD,CAA/B,EAAoC,QAAQ,CAAC,CAAD,CAA5C,EAAiD,WAAW,CAAC,CAAD,CAA5D,CAAhB;;AAEA,cAAI,OAAO,GAAG,MAAd,EAAoB;AAClB,YAAA,MAAI,GAAG,OAAP;AACD;;AAED,cAAI,OAAO,GAAG,MAAd,EAAoB;AAClB,YAAA,MAAI,GAAG,OAAP;AACD;;AAED,cAAI,OAAO,GAAG,MAAd,EAAoB;AAClB,YAAA,MAAI,GAAG,OAAP;AACD;;AAED,cAAI,OAAO,GAAG,MAAd,EAAoB;AAClB,YAAA,MAAI,GAAG,OAAP;AACD;AACF;AACF,OAlCD;AAmCD,KApCD,MAoCO;AACL,MAAA,MAAI,GAAG,CAAP;AACA,MAAA,MAAI,GAAG,CAAP;AACA,MAAA,MAAI,GAAG,CAAP;AACA,MAAA,MAAI,GAAG,CAAP;AACD;;AACD,IAAA,IAAI,GAAG,UAAU,CAAC,MAAD,EAAO,MAAP,EAAa,MAAI,GAAG,MAApB,EAA0B,MAAI,GAAG,MAAjC,CAAjB;AACD;;AACD,MAAI,QAAJ,EAAc;AACZ,WAAO,aAAa,CAAC,IAAD,EAAO,QAAP,CAApB;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF;;AA9DD,OAAA,CAAA,eAAA,GAAA,eAAA;;AAgEA,SAAgB,UAAhB,CAA2B,OAA3B,EAA8C,UAA9C,EAAkE;AAChE,MAAI,CAAC,OAAO,CAAC,OAAR,EAAD,IAAsB,CAAC,UAAU,CAAC,OAAX,EAA3B,EAAiD;AAC/C;AACA;AACD;;AACD,MAAM,YAAY,GAAG,UAAU,CAAC,OAAX,EAArB;;AACA,MAAI,CAAC,YAAL,EAAmB;AACjB;AACA,IAAA,OAAO,CAAC,OAAR,CAAgB,IAAhB,EAFiB,CAEM;;AACvB;AACD;;AACD,MAAM,OAAO,GAAG;AACd,IAAA,IAAI,EAAE,YAAY,CAAC,GAAb,CAAiB,MAAjB,CADQ;AAEd,IAAA,KAAK,EAAE,YAAY,CAAC,IAAb;AAFO,GAAhB;AAIA,EAAA,OAAO,CAAC,OAAR,CAAgB,OAAhB;AACD;;AAhBD,OAAA,CAAA,UAAA,GAAA,UAAA;;AAkBA,SAAgB,IAAhB,CAAqB,MAArB,EAA2B;AACzB,SAAU,MAAM,GAAA,IAAhB;AACD;;AAFD,OAAA,CAAA,IAAA,GAAA,IAAA;;AAIA,SAAgB,YAAhB,CAA6B,KAA7B,EAA2C,GAA3C,EAAuD,QAAvD,EAAyE,MAAzE,EAAuF;AACrF,MAAM,UAAU,GAAG,QAAQ,CAAC,KAAD,EAAQ,GAAR,CAA3B;AACA,MAAM,aAAa,GAAG,MAAM,GAAG,UAA/B,CAFqF,CAE1C;;AAC3C,MAAI,OAAO,GAAG,CAAd;;AACA,MAAI,QAAQ,KAAK,OAAjB,EAA0B;AACxB,IAAA,OAAO,GAAG,IAAI,aAAd;AACD,GAFD,MAEO,IAAI,QAAQ,KAAK,KAAjB,EAAwB;AAC7B,IAAA,OAAO,GAAG,IAAI,aAAd;AACD;;AACD,SAAO;AACL,IAAA,CAAC,EAAE,iBAAiB,CAAC,KAAK,CAAC,CAAP,EAAU,GAAG,CAAC,CAAd,EAAiB,OAAjB,CADf;AAEL,IAAA,CAAC,EAAE,iBAAiB,CAAC,KAAK,CAAC,CAAP,EAAU,GAAG,CAAC,CAAd,EAAiB,OAAjB;AAFf,GAAP;AAID;;AAbD,OAAA,CAAA,YAAA,GAAA,YAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTextPoint = exports.toPx = exports.updateClip = exports.getBBoxWithClip = exports.mergeBBox = exports.intersectBBox = exports.near = exports.wait = exports.distance = exports.getCirclePoint = exports.getValueByPercent = exports.createBBox = exports.pointsToBBox = exports.regionToBBox = exports.hasClass = exports.clearDom = exports.formatPadding = void 0;\nvar util_1 = require(\"@antv/util\");\nfunction formatPadding(padding) {\n    var top = 0;\n    var left = 0;\n    var right = 0;\n    var bottom = 0;\n    if (util_1.isNumber(padding)) {\n        top = left = right = bottom = padding;\n    }\n    else if (util_1.isArray(padding)) {\n        top = padding[0];\n        right = !util_1.isNil(padding[1]) ? padding[1] : padding[0];\n        bottom = !util_1.isNil(padding[2]) ? padding[2] : padding[0];\n        left = !util_1.isNil(padding[3]) ? padding[3] : right;\n    }\n    return [top, right, bottom, left];\n}\nexports.formatPadding = formatPadding;\nfunction clearDom(container) {\n    var children = container.childNodes;\n    var length = children.length;\n    for (var i = length - 1; i >= 0; i--) {\n        container.removeChild(children[i]);\n    }\n}\nexports.clearDom = clearDom;\nfunction hasClass(elements, cName) {\n    return !!elements.className.match(new RegExp(\"(\\\\s|^)\" + cName + \"(\\\\s|$)\"));\n}\nexports.hasClass = hasClass;\nfunction regionToBBox(region) {\n    var start = region.start, end = region.end;\n    var minX = Math.min(start.x, end.x);\n    var minY = Math.min(start.y, end.y);\n    var maxX = Math.max(start.x, end.x);\n    var maxY = Math.max(start.y, end.y);\n    return {\n        x: minX,\n        y: minY,\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY,\n        width: maxX - minX,\n        height: maxY - minY,\n    };\n}\nexports.regionToBBox = regionToBBox;\nfunction pointsToBBox(points) {\n    var xs = points.map(function (point) { return point.x; });\n    var ys = points.map(function (point) { return point.y; });\n    var minX = Math.min.apply(Math, xs);\n    var minY = Math.min.apply(Math, ys);\n    var maxX = Math.max.apply(Math, xs);\n    var maxY = Math.max.apply(Math, ys);\n    return {\n        x: minX,\n        y: minY,\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY,\n        width: maxX - minX,\n        height: maxY - minY,\n    };\n}\nexports.pointsToBBox = pointsToBBox;\nfunction createBBox(x, y, width, height) {\n    return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        minX: x,\n        minY: y,\n        maxX: x + width,\n        maxY: y + height,\n    };\n}\nexports.createBBox = createBBox;\nfunction getValueByPercent(min, max, percent) {\n    return (1 - percent) * min + max * percent;\n}\nexports.getValueByPercent = getValueByPercent;\nfunction getCirclePoint(center, radius, angle) {\n    return {\n        x: center.x + Math.cos(angle) * radius,\n        y: center.y + Math.sin(angle) * radius,\n    };\n}\nexports.getCirclePoint = getCirclePoint;\nfunction distance(p1, p2) {\n    var dx = p2.x - p1.x;\n    var dy = p2.y - p1.y;\n    return Math.sqrt(dx * dx + dy * dy);\n}\nexports.distance = distance;\nexports.wait = function (interval) {\n    return new Promise(function (resolve) {\n        setTimeout(resolve, interval);\n    });\n};\nexports.near = function (x, y) {\n    return [x, y].includes(Infinity) ? Math.abs(x) === Math.abs(y) : Math.abs(x - y) < Math.pow(Number.EPSILON, 0.5);\n};\nfunction intersectBBox(box1, box2) {\n    var minX = Math.max(box1.minX, box2.minX);\n    var minY = Math.max(box1.minY, box2.minY);\n    var maxX = Math.min(box1.maxX, box2.maxX);\n    var maxY = Math.min(box1.maxY, box2.maxY);\n    return createBBox(minX, minY, maxX - minX, maxY - minY);\n}\nexports.intersectBBox = intersectBBox;\nfunction mergeBBox(box1, box2) {\n    var minX = Math.min(box1.minX, box2.minX);\n    var minY = Math.min(box1.minY, box2.minY);\n    var maxX = Math.max(box1.maxX, box2.maxX);\n    var maxY = Math.max(box1.maxY, box2.maxY);\n    return createBBox(minX, minY, maxX - minX, maxY - minY);\n}\nexports.mergeBBox = mergeBBox;\nfunction getBBoxWithClip(element) {\n    var clipShape = element.getClip();\n    var clipBBox = clipShape && clipShape.getBBox();\n    var bbox;\n    if (!element.isGroup()) {\n        // 如果是普通的图形\n        bbox = element.getBBox();\n    }\n    else {\n        var minX_1 = Infinity;\n        var maxX_1 = -Infinity;\n        var minY_1 = Infinity;\n        var maxY_1 = -Infinity;\n        var children = element.getChildren();\n        if (children.length > 0) {\n            util_1.each(children, function (child) {\n                if (child.get('visible')) {\n                    // 如果分组没有子元素，则直接跳过\n                    if (child.isGroup() && child.get('children').length === 0) {\n                        return true;\n                    }\n                    var box = getBBoxWithClip(child);\n                    // 计算 4 个顶点\n                    var leftTop = child.applyToMatrix([box.minX, box.minY, 1]);\n                    var leftBottom = child.applyToMatrix([box.minX, box.maxY, 1]);\n                    var rightTop = child.applyToMatrix([box.maxX, box.minY, 1]);\n                    var rightBottom = child.applyToMatrix([box.maxX, box.maxY, 1]);\n                    // 从中取最小的范围\n                    var boxMinX = Math.min(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\n                    var boxMaxX = Math.max(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\n                    var boxMinY = Math.min(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\n                    var boxMaxY = Math.max(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\n                    if (boxMinX < minX_1) {\n                        minX_1 = boxMinX;\n                    }\n                    if (boxMaxX > maxX_1) {\n                        maxX_1 = boxMaxX;\n                    }\n                    if (boxMinY < minY_1) {\n                        minY_1 = boxMinY;\n                    }\n                    if (boxMaxY > maxY_1) {\n                        maxY_1 = boxMaxY;\n                    }\n                }\n            });\n        }\n        else {\n            minX_1 = 0;\n            maxX_1 = 0;\n            minY_1 = 0;\n            maxY_1 = 0;\n        }\n        bbox = createBBox(minX_1, minY_1, maxX_1 - minX_1, maxY_1 - minY_1);\n    }\n    if (clipBBox) {\n        return intersectBBox(bbox, clipBBox);\n    }\n    else {\n        return bbox;\n    }\n}\nexports.getBBoxWithClip = getBBoxWithClip;\nfunction updateClip(element, newElement) {\n    if (!element.getClip() && !newElement.getClip()) {\n        // 两者都没有 clip\n        return;\n    }\n    var newClipShape = newElement.getClip();\n    if (!newClipShape) {\n        // 新的 element 没有 clip\n        element.setClip(null); // 移除 clip\n        return;\n    }\n    var clipCfg = {\n        type: newClipShape.get('type'),\n        attrs: newClipShape.attr(),\n    };\n    element.setClip(clipCfg);\n}\nexports.updateClip = updateClip;\nfunction toPx(number) {\n    return number + \"px\";\n}\nexports.toPx = toPx;\nfunction getTextPoint(start, end, position, offset) {\n    var lineLength = distance(start, end);\n    var offsetPercent = offset / lineLength; // 计算间距同线的比例，用于计算最终的位置\n    var percent = 0;\n    if (position === 'start') {\n        percent = 0 - offsetPercent;\n    }\n    else if (position === 'end') {\n        percent = 1 + offsetPercent;\n    }\n    return {\n        x: getValueByPercent(start.x, end.x, percent),\n        y: getValueByPercent(start.y, end.y, percent),\n    };\n}\nexports.getTextPoint = getTextPoint;\n//# sourceMappingURL=util.js.map"]},"metadata":{},"sourceType":"script"}